<!doctype html>
<html class="no-js">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>写新博客</title>
    <meta name="description" content="写新博客页面">
    <meta name="keywords" content="index">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="renderer" content="webkit">
    <meta http-equiv="Cache-Control" content="no-siteapp" />
    <link rel="icon" type="image/png" href="__PUBLIC__/AmazeUI-2.5.2/assets/i/favicon.png">
    <link rel="apple-touch-icon-precomposed" href="__PUBLIC__/AmazeUI-2.5.2/assets/i/app-icon72x72@2x.png">
    <meta name="apple-mobile-web-app-title" content="Amaze UI" />
    <link rel="stylesheet" href="__PUBLIC__/AmazeUI-2.5.2/assets/css/amazeui.min.css"/>
    <link rel="stylesheet" href="__PUBLIC__/AmazeUI-2.5.2/assets/css/admin.css">

    <!-- UEditor-->
    <script type="text/javascript" charset="utf-8" src="__PUBLIC__/ueditor/ueditor.config.js"></script>
    <script type="text/javascript" charset="utf-8" src="__PUBLIC__/ueditor/ueditor.all.min.js"> </script>
    <!--建议手动加在语言，避免在ie下有时因为加载语言失败导致编辑器加载失败-->
    <!--这里加载的语言文件会覆盖你在配置项目里添加的语言类型，比如你在配置项目里配置的是英文，这里加载的中文，那最后就是中文-->
    <script type="text/javascript" charset="utf-8" src="__PUBLIC__/ueditor/lang/zh-cn/zh-cn.js"></script>
    <!-- UEditor-->
</head>
<body>
<!--[if lte IE 9]>
<p class="browsehappy">你正在使用<strong>过时</strong>的浏览器，Amaze UI 暂不支持。 请 <a href="http://browsehappy.com/" target="_blank">升级浏览器</a>
    以获得更好的体验！</p>
<![endif]-->

<header class="am-topbar admin-header">
    <div class="am-topbar-brand">
        <strong>StarBall</strong> <small>后台管理</small>
    </div>

    <button class="am-topbar-btn am-topbar-toggle am-btn am-btn-sm am-btn-success am-show-sm-only" data-am-collapse="{target: '#topbar-collapse'}"><span class="am-sr-only">导航切换</span> <span class="am-icon-bars"></span></button>

    <div class="am-collapse am-topbar-collapse" id="topbar-collapse">

        <ul class="am-nav am-nav-pills am-topbar-nav am-topbar-right admin-header-list">
            <li><a href="javascript:;"><span class="am-icon-envelope-o"></span> 收件箱 <span class="am-badge am-badge-warning">5</span></a></li>
            <li class="am-dropdown" data-am-dropdown>
                <a class="am-dropdown-toggle" data-am-dropdown-toggle href="javascript:;">
                    <span class="am-icon-users"></span> 管理员 <span class="am-icon-caret-down"></span>
                </a>
                <ul class="am-dropdown-content">
                    <li><a href="#"><span class="am-icon-user"></span> 资料</a></li>
                    <li><a href="#"><span class="am-icon-cog"></span> 设置</a></li>
                    <li><a href="#"><span class="am-icon-power-off"></span> 退出</a></li>
                </ul>
            </li>
            <li class="am-hide-sm-only"><a href="javascript:;" id="admin-fullscreen"><span class="am-icon-arrows-alt"></span> <span class="admin-fullText">开启全屏</span></a></li>
        </ul>
    </div>
</header>

<div class="am-cf admin-main">
    <!-- sidebar start -->
    <div class="admin-sidebar am-offcanvas" id="admin-offcanvas">
        <div class="am-offcanvas-bar admin-offcanvas-bar">
            <ul class="am-list admin-sidebar-list">
                <li><a href="../Order" target="_blank"><span class="am-icon-home"></span> 订单管理</a></li>
                <li><a href="../Order/cancel" target="_blank"><span class="am-icon-home"></span> 退单管理</a></li>
                <li><a href="../Brand" target="_blank"><span class="am-icon-square"></span> 品牌管理</a></li>
                <li class="admin-parent">
                    <a class="am-cf" data-am-collapse="{target: '#collapse-nav'}"><span class="am-icon-file"></span> 商品管理 <span class="am-icon-angle-right am-fr am-margin-right"></span></a>
                    <ul class="am-list am-collapse admin-sidebar-sub am-in" id="collapse-nav">
                        <li><a href="../Item/upload" class="am-cf" target="_blank"><span class="am-icon-upload"></span> 商品上新</a></li>
                        <li><a href="../Item/search" target="_blank"><span class="am-icon-search"></span> 商品搜索</a></li>
                        <li><a href="../Item/mainPageSetting" target="_blank"><span class="am-icon-search"></span> 首页上新</a></li>
                    </ul>
                </li>
                <li class="admin-parent">
                    <a class="am-cf" data-am-collapse="{target: '#blog-nav'}"><span class="am-icon-file"></span> 博客 <span class="am-icon-angle-right am-fr am-margin-right"></span></a>
                    <ul class="am-list am-collapse admin-sidebar-sub am-in" id="blog-nav">
                        <li><a href="./search" class="am-cf" target="_blank"><span class="am-icon-search"></span> 博客管理</a></li>
                        <li><a href="./create" target="_blank"><span class="am-icon-upload"></span> 写新博客</a></li>
                    </ul>
                </li>
                <li class="admin-parent">
                    <a class="am-cf" data-am-collapse="{target: '#data-nav'}"><span class="am-icon-file"></span> 支持数据 <span class="am-icon-angle-right am-fr am-margin-right"></span></a>
                    <ul class="am-list am-collapse admin-sidebar-sub am-in" id="data-nav">
                        <li><a href="../Data" class="am-cf" target="_blank"><span class="am-icon-search"></span> 支持数据管理</a></li>
                        <li><a href="../Data/create" target="_blank"><span class="am-icon-upload"></span> 添加支持数据</a></li>
                    </ul>
                </li>
                <li><a href="#"><span class="am-icon-sign-out"></span> 注销</a></li>
            </ul>
        </div>
    </div>
    <!-- sidebar end -->

    <!-- content start -->
    <div class="admin-content">
        <div class="am-g">
            <!-- blog writing area -->
            <div class="am-u-sm-12">
                <form class="am-form" method="post" enctype="multipart/form-data">
                    <fieldset>
                        <legend>写新博客</legend>
                        <div class="am-form-group">
                            <label for="blog-title">标题</label>
                            <input type="text" class="" name="title" id="blog-title" placeholder="输入博客标题">
                        </div>
                        <div class="am-form-group">
                            <label for="blog-abstract">摘要</label>
                            <textarea class="" rows="3" name="abstract" id="blog-abstract" placeholder="输入博客摘要"></textarea>
                        </div>
                        <p><button type="button" id="save-as-draft" class="am-btn am-btn-default">存为草稿</button></p>
                        <p><button type="button" id="save-as-publish" class="am-btn am-btn-default">发布</button></p>
                    </fieldset>
                </form>
                <script id="editor" type="text/plain" style="height:500px;"></script>
            </div>
        </div>
    </div>
</div>
</div>
<!-- 内容不完整 -->
<div class="am-modal am-modal-alert" tabindex="-1" id="warn">
    <div class="am-modal-dialog">
        <div class="am-modal-hd">请把内容填写完整</div>
        <div class="am-modal-bd">
            请把内容填写完整
        </div>
        <div class="am-modal-footer">
            <span class="am-modal-btn">确定</span>
        </div>
    </div>
</div>

<!-- 提交成功 -->
<div class="am-modal am-modal-alert" tabindex="-1" id="save-success">
    <div class="am-modal-dialog">
        <div class="am-modal-hd">保存成功</div>
        <div class="am-modal-bd">
            保存成功
        </div>
        <div class="am-modal-footer">
            <span class="am-modal-btn">确定</span>
        </div>
    </div>
</div>

<!-- 提交失败 -->
<div class="am-modal am-modal-alert" tabindex="-1" id="save-fail">
    <div class="am-modal-dialog">
        <div class="am-modal-hd">保存失败</div>
        <div class="am-modal-bd">
            保存失败
        </div>
        <div class="am-modal-footer">
            <span class="am-modal-btn">确定</span>
        </div>
    </div>
</div>

</div>
</div>
<!-- content end -->

</div>

<a href="#" class="am-show-sm-only admin-menu" data-am-offcanvas="{target: '#admin-offcanvas'}">
    <span class="am-icon-btn am-icon-th-list"></span>
</a>

<footer>
    <hr>
    <p class="am-padding-left">© 2016 UltraBravo Inc.</p>
</footer>

<!--[if lt IE 9]>
<script src="http://libs.baidu.com/jquery/1.11.1/jquery.min.js"></script>
<script src="http://cdn.staticfile.org/modernizr/2.8.3/modernizr.js"></script>
<script src="assets/js/amazeui.ie8polyfill.min.js"></script>
<![endif]-->

<!--[if (gte IE 9)|!(IE)]><!-->
<script src="__PUBLIC__/AmazeUI-2.5.2/assets/js/jquery.min.js"></script>
<!--<![endif]-->
<script src="__PUBLIC__/AmazeUI-2.5.2/assets/js/amazeui.min.js"></script>
<script src="__PUBLIC__/AmazeUI-2.5.2/assets/js/app.js"></script>
<!-- 自己的JS代码-->
<script>
    //实例化编辑器
    //建议使用工厂方法getEditor创建和引用编辑器实例，如果在某个闭包下引用该编辑器，直接调用UE.getEditor('editor')就能拿到相关的实例
    UE.getEditor('editor');
    function checkInputFields() {
        if ($("#blog-title").val().trim() == "") {
            return false;
        }
        if ($("#blog-abstract").val().trim() == "") {
            return false;
        }
    }
    $("#save-as-draft").click(function(){
        if (checkInputFields() == false) {
            $("#warn").modal("open");
        } else {
            var data = {};
            data["status"] = "0";
            data["title"] = $("#blog-title").val().trim();
            data["abstract"] = $("#blog-abstract").val().trim();
            data["content"] = UE.getEditor('editor').getContent();
            $.post("./saveAsDraft",data,function(result){
                if (($.parseJSON(result)).status == "1") {
                    $("#save-success").modal("open");
                } else {
                    $("#save-fail").modal("open");
                }
            });
        }
    });
    $("#save-as-publish").click(function(){
        if (checkInputFields() == false) {
            $("#warn").modal("open");
        } else {
            var data = {};
            data["status"] = "1";
            data["title"] = $("#blog-title").val().trim();
            data["abstract"] = $("#blog-abstract").val().trim();
            data["content"] = UE.getEditor('editor').getContent();
            $.post("./saveAsPublish",data,function(result){
                if (($.parseJSON(result)).status == "1") {
                    $("#save-success").modal("open");
                } else {
                    $("#save-fail").modal("open");
                }
            });
        }
    });
</script>
</body>
</html>
